---
import Layout from "@layouts/Layout.astro";
import AudioCard from '@components/AudioCard.astro'
import AudioPlayer from '@components/AudioPlayer.astro'
import PaginationAudio from '@components/PaginationAudio.astro'
import { getCollection } from 'astro:content'
import { SITE } from "@config";

export async function getStaticPaths({ paginate }) {
  const audioCollection = await getCollection('audio')
  audioCollection.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  return paginate(audioCollection, { pageSize: SITE.pageSize })
}
const { page } = Astro.props
---

<Layout>
  <div class="card mt-12 min-w-full bg-base-100 p-3 pb-3 shadow-md">
    {
      page.data.map((audio: any, index: number) => (
        <AudioCard
          title={audio.data.title}
          cover={audio.data.cover}
          desc={audio.data.description}
          audioUrl={audio.data.audioUrl}
          date={audio.data.date}
          duration={audio.data.duration}
          id={'card-' + index}
        />
      ))
    }
  </div>
  <PaginationAudio page={page} />
</Layout>

<AudioPlayer />
